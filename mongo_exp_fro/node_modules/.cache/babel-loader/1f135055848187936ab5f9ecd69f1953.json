{"ast":null,"code":"import '../../../../utils/index.mjs';\nimport '../../../../constants/index.mjs';\nimport { EVENT_CODE } from '../../../../constants/aria.mjs';\nimport { triggerEvent } from '../../../../utils/dom/aria.mjs';\n\nclass SubMenu {\n  constructor(parent, domNode) {\n    this.parent = parent;\n    this.domNode = domNode;\n    this.subIndex = 0;\n    this.subIndex = 0;\n    this.init();\n  }\n\n  init() {\n    this.subMenuItems = this.domNode.querySelectorAll(\"li\");\n    this.addListeners();\n  }\n\n  gotoSubIndex(idx) {\n    if (idx === this.subMenuItems.length) {\n      idx = 0;\n    } else if (idx < 0) {\n      idx = this.subMenuItems.length - 1;\n    }\n\n    ;\n    this.subMenuItems[idx].focus();\n    this.subIndex = idx;\n  }\n\n  addListeners() {\n    const parentNode = this.parent.domNode;\n    Array.prototype.forEach.call(this.subMenuItems, el => {\n      el.addEventListener(\"keydown\", event => {\n        let prevDef = false;\n\n        switch (event.code) {\n          case EVENT_CODE.down:\n            {\n              this.gotoSubIndex(this.subIndex + 1);\n              prevDef = true;\n              break;\n            }\n\n          case EVENT_CODE.up:\n            {\n              this.gotoSubIndex(this.subIndex - 1);\n              prevDef = true;\n              break;\n            }\n\n          case EVENT_CODE.tab:\n            {\n              triggerEvent(parentNode, \"mouseleave\");\n              break;\n            }\n\n          case EVENT_CODE.enter:\n          case EVENT_CODE.space:\n            {\n              prevDef = true;\n              event.currentTarget.click();\n              break;\n            }\n        }\n\n        if (prevDef) {\n          event.preventDefault();\n          event.stopPropagation();\n        }\n\n        return false;\n      });\n    });\n  }\n\n}\n\nexport { SubMenu as default };","map":{"version":3,"mappings":";;;;;AAEA,MAAMA,OAAN,CAAc;EACZC,WAAW,CAACC,MAAD,EAASC,OAAT,EAAkB;IAC3B,KAAKD,MAAL,GAAcA,MAAd;IACA,KAAKC,OAAL,GAAeA,OAAf;IACA,KAAKC,QAAL,GAAgB,CAAhB;IACA,KAAKA,QAAL,GAAgB,CAAhB;IACA,KAAKC,IAAL;EACD;;EACDA,IAAI,GAAG;IACL,KAAKC,YAAL,GAAoB,KAAKH,OAAL,CAAaI,gBAAb,CAA8B,IAA9B,CAApB;IACA,KAAKC,YAAL;EACD;;EACDC,YAAY,CAACC,GAAD,EAAM;IAChB,IAAIA,GAAG,KAAK,KAAKJ,YAAL,CAAkBK,MAA9B,EAAsC;MACpCD,GAAG,GAAG,CAAN;IACD,CAFD,MAEO,IAAIA,GAAG,GAAG,CAAV,EAAa;MAClBA,GAAG,GAAG,KAAKJ,YAAL,CAAkBK,MAAlB,GAA2B,CAAjC;IACD;;IACD;IACA,KAAKL,YAAL,CAAkBI,GAAlB,EAAuBE,KAAvB;IACA,KAAKR,QAAL,GAAgBM,GAAhB;EACD;;EACDF,YAAY,GAAG;IACb,MAAMK,UAAU,GAAG,KAAKX,MAAL,CAAYC,OAA/B;IACAW,KAAK,CAACC,SAAN,CAAgBC,OAAhB,CAAwBC,IAAxB,CAA6B,KAAKX,YAAlC,EAAiDY,EAAD,IAAQ;MACtDA,EAAE,CAACC,gBAAH,CAAoB,SAApB,EAAgCC,KAAD,IAAW;QACxC,IAAIC,OAAO,GAAG,KAAd;;QACA,QAAQD,KAAK,CAACE,IAAd;UACE,KAAKC,UAAU,CAACC,IAAhB;YAAsB;cACpB,KAAKf,YAAL,CAAkB,KAAKL,QAAL,GAAgB,CAAlC;cACAiB,OAAO,GAAG,IAAV;cACA;YACD;;UACD,KAAKE,UAAU,CAACE,EAAhB;YAAoB;cAClB,KAAKhB,YAAL,CAAkB,KAAKL,QAAL,GAAgB,CAAlC;cACAiB,OAAO,GAAG,IAAV;cACA;YACD;;UACD,KAAKE,UAAU,CAACG,GAAhB;YAAqB;cACnBC,YAAY,CAACd,UAAD,EAAa,YAAb,CAAZ;cACA;YACD;;UACD,KAAKU,UAAU,CAACK,KAAhB;UACA,KAAKL,UAAU,CAACM,KAAhB;YAAuB;cACrBR,OAAO,GAAG,IAAV;cACAD,KAAK,CAACU,aAAN,CAAoBC,KAApB;cACA;YACD;QApBH;;QAsBA,IAAIV,OAAJ,EAAa;UACXD,KAAK,CAACY,cAAN;UACAZ,KAAK,CAACa,eAAN;QACD;;QACD,OAAO,KAAP;MACD,CA7BD;IA8BD,CA/BD;EAgCD;;AAxDW","names":["SubMenu","constructor","parent","domNode","subIndex","init","subMenuItems","querySelectorAll","addListeners","gotoSubIndex","idx","length","focus","parentNode","Array","prototype","forEach","call","el","addEventListener","event","prevDef","code","EVENT_CODE","down","up","tab","triggerEvent","enter","space","currentTarget","click","preventDefault","stopPropagation"],"sources":["../../../../../../../packages/components/menu/src/utils/submenu.ts"],"sourcesContent":["// @ts-nocheck\nimport { triggerEvent } from '@element-plus/utils'\nimport { EVENT_CODE } from '@element-plus/constants'\nimport type MenuItem from './menu-item'\n\nclass SubMenu {\n  public subMenuItems: NodeList\n  public subIndex = 0\n  constructor(public parent: MenuItem, public domNode: ParentNode) {\n    this.subIndex = 0\n    this.init()\n  }\n\n  init(): void {\n    this.subMenuItems = this.domNode.querySelectorAll('li')\n    this.addListeners()\n  }\n\n  gotoSubIndex(idx: number): void {\n    if (idx === this.subMenuItems.length) {\n      idx = 0\n    } else if (idx < 0) {\n      idx = this.subMenuItems.length - 1\n    }\n    ;(this.subMenuItems[idx] as HTMLElement).focus()\n    this.subIndex = idx\n  }\n\n  addListeners(): void {\n    const parentNode = this.parent.domNode\n    Array.prototype.forEach.call(this.subMenuItems, (el: Element) => {\n      el.addEventListener('keydown', (event: KeyboardEvent) => {\n        let prevDef = false\n        switch (event.code) {\n          case EVENT_CODE.down: {\n            this.gotoSubIndex(this.subIndex + 1)\n            prevDef = true\n            break\n          }\n          case EVENT_CODE.up: {\n            this.gotoSubIndex(this.subIndex - 1)\n            prevDef = true\n            break\n          }\n          case EVENT_CODE.tab: {\n            triggerEvent(parentNode as HTMLElement, 'mouseleave')\n            break\n          }\n          case EVENT_CODE.enter:\n          case EVENT_CODE.space: {\n            prevDef = true\n            ;(event.currentTarget as HTMLElement).click()\n            break\n          }\n        }\n        if (prevDef) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n        return false\n      })\n    })\n  }\n}\n\nexport default SubMenu\n"]},"metadata":{},"sourceType":"module"}