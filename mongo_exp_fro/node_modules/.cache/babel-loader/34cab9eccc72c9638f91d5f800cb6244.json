{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport request from \"../../untils/request\";\nexport default {\n  name: \"managerHeader\",\n  components: {},\n\n  data() {\n    let validatePassword = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.passwordForm.newPassword) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      personDialogVisible: false,\n      //控制个人信息弹窗\n      passwordDialogVisible: false,\n      //控制修改密码弹窗\n      form: {},\n      //用于获取user\n      passwordForm: {},\n      //用于传输密码更新\n      rules: {\n        originalPassword: [{\n          required: true,\n          trigger: \"blur\",\n          message: \"请输入原密码\"\n        }],\n        newPassword: [{\n          pattern: /^(?!\\d+$)(?![a-zA-Z]+$)(?![^\\da-zA-Z]+$)([^\\u4e00-\\u9fa5\\s]){8,16}$/,\n          required: true,\n          message: \"只能输入8-16位英文字母、数字或者符号（除空格），且字母、数字和标点符号至少包含两种\",\n          trigger: \"blur\"\n        }],\n        newPasswords: [{\n          validator: validatePassword,\n          required: true,\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n\n  created() {\n    let str = sessionStorage.getItem(\"user\");\n    this.form = JSON.parse(str);\n  },\n\n  methods: {\n    sexTranslate(sex) {\n      if (sex === 0) return \"男\";\n      if (sex === 1) return \"女\";\n    },\n\n    save() {\n      request.post(\"/user/update\", this.form).then(res => {\n        if (res.code === 0) {\n          this.$message({\n            type: \"success\",\n            message: \"保存成功\"\n          });\n          sessionStorage.removeItem(\"user\");\n          sessionStorage.setItem(\"user\", JSON.stringify(res.data)); //缓存用户信息\n\n          let str = sessionStorage.getItem(\"user\");\n          this.form = JSON.parse(str);\n          this.personDialogVisible = false;\n        } else {\n          this.$message({\n            type: \"error\",\n            message: res.msg\n          });\n        }\n      });\n    },\n\n    updatePassword() {\n      this.$refs[\"passwordForm\"].validate(valid => {\n        if (valid) {\n          this.passwordForm.userID = this.form.id;\n          request.post(\"/user/updatePassword\", this.passwordForm).then(res => {\n            if (res.code === 0) {\n              this.$message({\n                type: \"success\",\n                message: \"修改成功\"\n              });\n              sessionStorage.removeItem(\"user\");\n              sessionStorage.setItem(\"user\", JSON.stringify(res.data)); //缓存用户信息\n\n              let str = sessionStorage.getItem(\"user\");\n              this.form = JSON.parse(str);\n              this.personDialogVisible = false;\n              this.passwordDialogVisible = false;\n            } else {\n              this.$message({\n                type: \"error\",\n                message: res.msg\n              });\n            }\n          });\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["request","name","components","data","validatePassword","rule","value","callback","Error","passwordForm","newPassword","personDialogVisible","passwordDialogVisible","form","rules","originalPassword","required","trigger","message","pattern","newPasswords","validator","created","str","sessionStorage","getItem","JSON","parse","methods","sexTranslate","sex","save","post","then","res","code","$message","type","removeItem","setItem","stringify","msg","updatePassword","$refs","validate","valid","userID","id"],"sourceRoot":"","sources":["C:\\Users\\laoshuaib\\Desktop\\restaurant\\src\\components\\managerHeader.vue"],"sourcesContent":["<!--suppress CssUnusedSymbol, JSUnusedGlobalSymbols -->\n<template>\n  <div\n    style=\"\n      height: 50px;\n      line-height: 50px;\n      border-bottom: 1px solid #ccc;\n      display: flex;\n      background: #fdf6ec;\n    \"\n  >\n    <div\n      style=\"\n        width: 200px;\n        padding-left: 50px;\n        font-weight: bold;\n        font-size: 18px;\n        color: #c95f5f;\n      \"\n    >\n      xx餐厅系统\n    </div>\n    <div style=\"flex: 1\"></div>\n    <div\n      style=\"\n        width: 150px;\n        font-weight: bold;\n        font-size: 18px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      \"\n    >\n      <el-dropdown size=\"large\">\n        <span>\n          {{ form.name }}\n          <el-icon><ArrowDownBold /></el-icon>\n        </span>\n        <template #dropdown>\n          <el-dropdown-menu>\n            <el-dropdown-item @click=\"personDialogVisible = true\"\n              >个人信息\n            </el-dropdown-item>\n            <el-dropdown-item @click=\"$router.push('/login')\" divided\n              >退出系统\n            </el-dropdown-item>\n          </el-dropdown-menu>\n        </template>\n      </el-dropdown>\n\n      <el-dialog v-model=\"personDialogVisible\" title=\"个人信息\" width=\"30%\">\n        <el-form :model=\"form\" label-width=\"80px\">\n          <el-form-item label=\"工号\">\n            <el-input v-model=\"form.id\" disabled></el-input>\n          </el-form-item>\n          <el-form-item label=\"姓名\">\n            <el-input v-model=\"form.name\" disabled></el-input>\n          </el-form-item>\n          <el-form-item label=\"电话\">\n            <el-input v-model.number=\"form.telephone\"></el-input>\n          </el-form-item>\n          <el-form-item>\n            <el-tag type=\"warning\" size=\"large\">经理</el-tag>\n            <div style=\"width: 20px\"></div>\n            <el-tag type=\"warning\" size=\"large\"\n              >{{ sexTranslate(form.sex) }}\n            </el-tag>\n          </el-form-item>\n        </el-form>\n        <template #footer>\n          <span>\n            <el-button @click=\"passwordDialogVisible = true\"\n              >修改密码</el-button\n            >\n            <el-button\n              type=\"primary\"\n              size=\"default\"\n              @click=\"save\"\n              color=\"#fab6b6\"\n              >保存</el-button\n            >\n          </span>\n        </template>\n      </el-dialog>\n\n      <el-dialog\n        ref=\"passwordForm\"\n        v-model=\"passwordDialogVisible\"\n        title=\"修改密码\"\n        width=\"30%\"\n      >\n        <el-form :model=\"passwordForm\" label-width=\"80px\" :rules=\"rules\">\n          <el-form-item label=\"原密码\" prop=\"originalPassword\">\n            <el-input\n              v-model=\"passwordForm.originalPassword\"\n              show-password\n            ></el-input>\n          </el-form-item>\n          <el-form-item label=\"新密码\" prop=\"newPassword\">\n            <el-input\n              v-model=\"passwordForm.newPassword\"\n              show-password\n            ></el-input>\n          </el-form-item>\n          <el-form-item label=\"再次输入\" prop=\"newPasswords\">\n            <el-input\n              v-model=\"passwordForm.newPasswords\"\n              show-password\n            ></el-input>\n          </el-form-item>\n        </el-form>\n        <template #footer>\n          <span>\n            <el-button\n              type=\"primary\"\n              size=\"default\"\n              color=\"#fab6b6\"\n              @click=\"updatePassword\"\n              >保存</el-button\n            >\n          </span>\n        </template>\n      </el-dialog>\n    </div>\n  </div>\n</template>\n\n<script>\nimport request from \"../../untils/request\";\n\nexport default {\n  name: \"managerHeader\",\n  components: {},\n  data() {\n    let validatePassword = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.passwordForm.newPassword) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n    return {\n      personDialogVisible: false, //控制个人信息弹窗\n      passwordDialogVisible: false, //控制修改密码弹窗\n      form: {}, //用于获取user\n      passwordForm: {}, //用于传输密码更新\n      rules: {\n        originalPassword: [\n          {\n            required: true,\n            trigger: \"blur\",\n            message: \"请输入原密码\",\n          },\n        ],\n        newPassword: [\n          {\n            pattern:\n              /^(?!\\d+$)(?![a-zA-Z]+$)(?![^\\da-zA-Z]+$)([^\\u4e00-\\u9fa5\\s]){8,16}$/,\n            required: true,\n            message:\n              \"只能输入8-16位英文字母、数字或者符号（除空格），且字母、数字和标点符号至少包含两种\",\n            trigger: \"blur\",\n          },\n        ],\n        newPasswords: [\n          { validator: validatePassword, required: true, trigger: \"blur\" },\n        ],\n      },\n    };\n  },\n  created() {\n    let str = sessionStorage.getItem(\"user\");\n    this.form = JSON.parse(str);\n  },\n  methods: {\n    sexTranslate(sex) {\n      if (sex === 0) return \"男\";\n      if (sex === 1) return \"女\";\n    },\n    save() {\n      request.post(\"/user/update\", this.form).then((res) => {\n        if (res.code === 0) {\n          this.$message({\n            type: \"success\",\n            message: \"保存成功\",\n          });\n          sessionStorage.removeItem(\"user\");\n          sessionStorage.setItem(\"user\", JSON.stringify(res.data)); //缓存用户信息\n          let str = sessionStorage.getItem(\"user\");\n          this.form = JSON.parse(str);\n          this.personDialogVisible = false;\n        } else {\n          this.$message({\n            type: \"error\",\n            message: res.msg,\n          });\n        }\n      });\n    },\n    updatePassword() {\n      this.$refs[\"passwordForm\"].validate((valid) => {\n        if (valid) {\n          this.passwordForm.userID = this.form.id;\n          request\n            .post(\"/user/updatePassword\", this.passwordForm)\n            .then((res) => {\n              if (res.code === 0) {\n                this.$message({\n                  type: \"success\",\n                  message: \"修改成功\",\n                });\n                sessionStorage.removeItem(\"user\");\n                sessionStorage.setItem(\"user\", JSON.stringify(res.data)); //缓存用户信息\n                let str = sessionStorage.getItem(\"user\");\n                this.form = JSON.parse(str);\n                this.personDialogVisible = false;\n                this.passwordDialogVisible = false;\n              } else {\n                this.$message({\n                  type: \"error\",\n                  message: res.msg,\n                });\n              }\n            });\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n/deep/ .el-input {\n  width: 85%;\n}\n\n/deep/ .el-dialog {\n  background: #fcf9f4;\n}\n\n/deep/.el-form-item {\n  margin-bottom: 30px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}