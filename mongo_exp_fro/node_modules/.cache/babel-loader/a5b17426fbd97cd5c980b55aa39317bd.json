{"ast":null,"code":"import { getCurrentInstance, inject, ref } from 'vue';\nimport { isClient } from '@vueuse/core';\nimport '../../../../utils/index.mjs';\nimport { TABLE_INJECTION_KEY } from '../tokens.mjs';\nimport { addClass, removeClass, hasClass } from '../../../../utils/dom/style.mjs';\n\nfunction useEvent(props, emit) {\n  const instance = getCurrentInstance();\n  const parent = inject(TABLE_INJECTION_KEY);\n\n  const handleFilterClick = event => {\n    event.stopPropagation();\n    return;\n  };\n\n  const handleHeaderClick = (event, column) => {\n    if (!column.filters && column.sortable) {\n      handleSortClick(event, column, false);\n    } else if (column.filterable && !column.sortable) {\n      handleFilterClick(event);\n    }\n\n    parent == null ? void 0 : parent.emit(\"header-click\", column, event);\n  };\n\n  const handleHeaderContextMenu = (event, column) => {\n    parent == null ? void 0 : parent.emit(\"header-contextmenu\", column, event);\n  };\n\n  const draggingColumn = ref(null);\n  const dragging = ref(false);\n  const dragState = ref({});\n\n  const handleMouseDown = (event, column) => {\n    if (!isClient) return;\n    if (column.children && column.children.length > 0) return;\n\n    if (draggingColumn.value && props.border) {\n      dragging.value = true;\n      const table = parent;\n      emit(\"set-drag-visible\", true);\n      const tableEl = table == null ? void 0 : table.vnode.el;\n      const tableLeft = tableEl.getBoundingClientRect().left;\n      const columnEl = instance.vnode.el.querySelector(`th.${column.id}`);\n      const columnRect = columnEl.getBoundingClientRect();\n      const minLeft = columnRect.left - tableLeft + 30;\n      addClass(columnEl, \"noclick\");\n      dragState.value = {\n        startMouseLeft: event.clientX,\n        startLeft: columnRect.right - tableLeft,\n        startColumnLeft: columnRect.left - tableLeft,\n        tableLeft\n      };\n      const resizeProxy = table == null ? void 0 : table.refs.resizeProxy;\n      resizeProxy.style.left = `${dragState.value.startLeft}px`;\n\n      document.onselectstart = function () {\n        return false;\n      };\n\n      document.ondragstart = function () {\n        return false;\n      };\n\n      const handleMouseMove2 = event2 => {\n        const deltaLeft = event2.clientX - dragState.value.startMouseLeft;\n        const proxyLeft = dragState.value.startLeft + deltaLeft;\n        resizeProxy.style.left = `${Math.max(minLeft, proxyLeft)}px`;\n      };\n\n      const handleMouseUp = () => {\n        if (dragging.value) {\n          const {\n            startColumnLeft,\n            startLeft\n          } = dragState.value;\n          const finalLeft = Number.parseInt(resizeProxy.style.left, 10);\n          const columnWidth = finalLeft - startColumnLeft;\n          column.width = column.realWidth = columnWidth;\n          table == null ? void 0 : table.emit(\"header-dragend\", column.width, startLeft - startColumnLeft, column, event);\n          requestAnimationFrame(() => {\n            props.store.scheduleLayout(false, true);\n          });\n          document.body.style.cursor = \"\";\n          dragging.value = false;\n          draggingColumn.value = null;\n          dragState.value = {};\n          emit(\"set-drag-visible\", false);\n        }\n\n        document.removeEventListener(\"mousemove\", handleMouseMove2);\n        document.removeEventListener(\"mouseup\", handleMouseUp);\n        document.onselectstart = null;\n        document.ondragstart = null;\n        setTimeout(() => {\n          removeClass(columnEl, \"noclick\");\n        }, 0);\n      };\n\n      document.addEventListener(\"mousemove\", handleMouseMove2);\n      document.addEventListener(\"mouseup\", handleMouseUp);\n    }\n  };\n\n  const handleMouseMove = (event, column) => {\n    var _a;\n\n    if (column.children && column.children.length > 0) return;\n    const target = (_a = event.target) == null ? void 0 : _a.closest(\"th\");\n    if (!column || !column.resizable) return;\n\n    if (!dragging.value && props.border) {\n      const rect = target.getBoundingClientRect();\n      const bodyStyle = document.body.style;\n\n      if (rect.width > 12 && rect.right - event.pageX < 8) {\n        bodyStyle.cursor = \"col-resize\";\n\n        if (hasClass(target, \"is-sortable\")) {\n          target.style.cursor = \"col-resize\";\n        }\n\n        draggingColumn.value = column;\n      } else if (!dragging.value) {\n        bodyStyle.cursor = \"\";\n\n        if (hasClass(target, \"is-sortable\")) {\n          target.style.cursor = \"pointer\";\n        }\n\n        draggingColumn.value = null;\n      }\n    }\n  };\n\n  const handleMouseOut = () => {\n    if (!isClient) return;\n    document.body.style.cursor = \"\";\n  };\n\n  const toggleOrder = ({\n    order,\n    sortOrders\n  }) => {\n    if (order === \"\") return sortOrders[0];\n    const index = sortOrders.indexOf(order || null);\n    return sortOrders[index > sortOrders.length - 2 ? 0 : index + 1];\n  };\n\n  const handleSortClick = (event, column, givenOrder) => {\n    var _a;\n\n    event.stopPropagation();\n    const order = column.order === givenOrder ? null : givenOrder || toggleOrder(column);\n    const target = (_a = event.target) == null ? void 0 : _a.closest(\"th\");\n\n    if (target) {\n      if (hasClass(target, \"noclick\")) {\n        removeClass(target, \"noclick\");\n        return;\n      }\n    }\n\n    if (!column.sortable) return;\n    const states = props.store.states;\n    let sortProp = states.sortProp.value;\n    let sortOrder;\n    const sortingColumn = states.sortingColumn.value;\n\n    if (sortingColumn !== column || sortingColumn === column && sortingColumn.order === null) {\n      if (sortingColumn) {\n        sortingColumn.order = null;\n      }\n\n      states.sortingColumn.value = column;\n      sortProp = column.property;\n    }\n\n    if (!order) {\n      sortOrder = column.order = null;\n    } else {\n      sortOrder = column.order = order;\n    }\n\n    states.sortProp.value = sortProp;\n    states.sortOrder.value = sortOrder;\n    parent == null ? void 0 : parent.store.commit(\"changeSortCondition\");\n  };\n\n  return {\n    handleHeaderClick,\n    handleHeaderContextMenu,\n    handleMouseDown,\n    handleMouseMove,\n    handleMouseOut,\n    handleSortClick,\n    handleFilterClick\n  };\n}\n\nexport { useEvent as default };","map":{"version":3,"mappings":"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","names":["useEvent","props","emit","instance","getCurrentInstance","parent","inject","TABLE_INJECTION_KEY","handleFilterClick","event","stopPropagation","handleHeaderClick","column","filters","sortable","handleSortClick","filterable","handleHeaderContextMenu","draggingColumn","ref","dragging","dragState","handleMouseDown","isClient","children","length","value","border","table","tableEl","vnode","el","tableLeft","getBoundingClientRect","left","columnEl","querySelector","id","columnRect","minLeft","addClass","startMouseLeft","clientX","startLeft","right","startColumnLeft","resizeProxy","refs","style","document","onselectstart","ondragstart","handleMouseMove2","event2","deltaLeft","proxyLeft","Math","max","handleMouseUp","finalLeft","Number","parseInt","columnWidth","width","realWidth","requestAnimationFrame","store","scheduleLayout","body","cursor","removeEventListener","setTimeout","removeClass","addEventListener","handleMouseMove","_a","target","closest","resizable","rect","bodyStyle","pageX","hasClass","handleMouseOut","toggleOrder","order","sortOrders","index","indexOf","givenOrder","states","sortProp","sortOrder","sortingColumn","property","commit"],"sources":["../../../../../../../packages/components/table/src/table-header/event-helper.ts"],"sourcesContent":["// @ts-nocheck\nimport { getCurrentInstance, inject, ref } from 'vue'\nimport { isClient } from '@vueuse/core'\nimport { addClass, hasClass, removeClass } from '@element-plus/utils'\nimport { TABLE_INJECTION_KEY } from '../tokens'\nimport type { TableHeaderProps } from '.'\nimport type { TableColumnCtx } from '../table-column/defaults'\n\nfunction useEvent<T>(props: TableHeaderProps<T>, emit) {\n  const instance = getCurrentInstance()\n  const parent = inject(TABLE_INJECTION_KEY)\n  const handleFilterClick = (event: Event) => {\n    event.stopPropagation()\n    return\n  }\n\n  const handleHeaderClick = (event: Event, column: TableColumnCtx<T>) => {\n    if (!column.filters && column.sortable) {\n      handleSortClick(event, column, false)\n    } else if (column.filterable && !column.sortable) {\n      handleFilterClick(event)\n    }\n    parent?.emit('header-click', column, event)\n  }\n\n  const handleHeaderContextMenu = (event: Event, column: TableColumnCtx<T>) => {\n    parent?.emit('header-contextmenu', column, event)\n  }\n  const draggingColumn = ref(null)\n  const dragging = ref(false)\n  const dragState = ref({})\n  const handleMouseDown = (event: MouseEvent, column: TableColumnCtx<T>) => {\n    if (!isClient) return\n    if (column.children && column.children.length > 0) return\n    /* istanbul ignore if */\n    if (draggingColumn.value && props.border) {\n      dragging.value = true\n\n      const table = parent\n      emit('set-drag-visible', true)\n      const tableEl = table?.vnode.el\n      const tableLeft = tableEl.getBoundingClientRect().left\n      const columnEl = instance.vnode.el.querySelector(`th.${column.id}`)\n      const columnRect = columnEl.getBoundingClientRect()\n      const minLeft = columnRect.left - tableLeft + 30\n\n      addClass(columnEl, 'noclick')\n\n      dragState.value = {\n        startMouseLeft: event.clientX,\n        startLeft: columnRect.right - tableLeft,\n        startColumnLeft: columnRect.left - tableLeft,\n        tableLeft,\n      }\n      const resizeProxy = table?.refs.resizeProxy as HTMLElement\n      resizeProxy.style.left = `${(dragState.value as any).startLeft}px`\n\n      document.onselectstart = function () {\n        return false\n      }\n      document.ondragstart = function () {\n        return false\n      }\n\n      const handleMouseMove = (event: MouseEvent) => {\n        const deltaLeft =\n          event.clientX - (dragState.value as any).startMouseLeft\n        const proxyLeft = (dragState.value as any).startLeft + deltaLeft\n\n        resizeProxy.style.left = `${Math.max(minLeft, proxyLeft)}px`\n      }\n\n      const handleMouseUp = () => {\n        if (dragging.value) {\n          const { startColumnLeft, startLeft } = dragState.value as any\n          const finalLeft = Number.parseInt(resizeProxy.style.left, 10)\n          const columnWidth = finalLeft - startColumnLeft\n          column.width = column.realWidth = columnWidth\n          table?.emit(\n            'header-dragend',\n            column.width,\n            startLeft - startColumnLeft,\n            column,\n            event\n          )\n          requestAnimationFrame(() => {\n            props.store.scheduleLayout(false, true)\n          })\n          document.body.style.cursor = ''\n          dragging.value = false\n          draggingColumn.value = null\n          dragState.value = {}\n          emit('set-drag-visible', false)\n        }\n\n        document.removeEventListener('mousemove', handleMouseMove)\n        document.removeEventListener('mouseup', handleMouseUp)\n        document.onselectstart = null\n        document.ondragstart = null\n\n        setTimeout(() => {\n          removeClass(columnEl, 'noclick')\n        }, 0)\n      }\n\n      document.addEventListener('mousemove', handleMouseMove)\n      document.addEventListener('mouseup', handleMouseUp)\n    }\n  }\n\n  const handleMouseMove = (event: MouseEvent, column: TableColumnCtx<T>) => {\n    if (column.children && column.children.length > 0) return\n\n    const target = (event.target as HTMLElement)?.closest('th')\n\n    if (!column || !column.resizable) return\n\n    if (!dragging.value && props.border) {\n      const rect = target.getBoundingClientRect()\n\n      const bodyStyle = document.body.style\n      if (rect.width > 12 && rect.right - event.pageX < 8) {\n        bodyStyle.cursor = 'col-resize'\n        if (hasClass(target, 'is-sortable')) {\n          target.style.cursor = 'col-resize'\n        }\n        draggingColumn.value = column\n      } else if (!dragging.value) {\n        bodyStyle.cursor = ''\n        if (hasClass(target, 'is-sortable')) {\n          target.style.cursor = 'pointer'\n        }\n        draggingColumn.value = null\n      }\n    }\n  }\n\n  const handleMouseOut = () => {\n    if (!isClient) return\n    document.body.style.cursor = ''\n  }\n  const toggleOrder = ({ order, sortOrders }) => {\n    if (order === '') return sortOrders[0]\n    const index = sortOrders.indexOf(order || null)\n    return sortOrders[index > sortOrders.length - 2 ? 0 : index + 1]\n  }\n  const handleSortClick = (\n    event: Event,\n    column: TableColumnCtx<T>,\n    givenOrder: string | boolean\n  ) => {\n    event.stopPropagation()\n    const order =\n      column.order === givenOrder ? null : givenOrder || toggleOrder(column)\n\n    const target = (event.target as HTMLElement)?.closest('th')\n\n    if (target) {\n      if (hasClass(target, 'noclick')) {\n        removeClass(target, 'noclick')\n        return\n      }\n    }\n\n    if (!column.sortable) return\n\n    const states = props.store.states\n    let sortProp = states.sortProp.value\n    let sortOrder\n    const sortingColumn = states.sortingColumn.value\n\n    if (\n      sortingColumn !== column ||\n      (sortingColumn === column && sortingColumn.order === null)\n    ) {\n      if (sortingColumn) {\n        sortingColumn.order = null\n      }\n      states.sortingColumn.value = column\n      sortProp = column.property\n    }\n    if (!order) {\n      sortOrder = column.order = null\n    } else {\n      sortOrder = column.order = order\n    }\n\n    states.sortProp.value = sortProp\n    states.sortOrder.value = sortOrder\n\n    parent?.store.commit('changeSortCondition')\n  }\n\n  return {\n    handleHeaderClick,\n    handleHeaderContextMenu,\n    handleMouseDown,\n    handleMouseMove,\n    handleMouseOut,\n    handleSortClick,\n    handleFilterClick,\n  }\n}\n\nexport default useEvent\n"]},"metadata":{},"sourceType":"module"}