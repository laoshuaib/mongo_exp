{"ast":null,"code":"import request from \"../../untils/request\";\nexport default {\n  name: \"orderMeal\",\n\n  data() {\n    return {\n      form: {},\n      tableData: [],\n      usingData: [],\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      search: \"\",\n      options: [{\n        value: 0,\n        label: \"堂食\"\n      }, {\n        value: 1,\n        label: \"外卖\"\n      }]\n    };\n  },\n\n  created() {\n    this.load();\n  },\n\n  methods: {\n    find() {\n      request.get(\"/cuisine/find\", {\n        params: {\n          pageNum: this.currentPage,\n          pageSize: this.pageSize,\n          search: this.search\n        }\n      }).then(res => {\n        this.tableData = res.data.records;\n        this.total = res.data.total;\n      });\n    },\n\n    forceConfirm() {\n      this.$confirm(\"强制下单将忽略并不执行对于储量的影响,是否继续\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"error\"\n      }).then(() => {\n        this.forceSave();\n      }).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"已取消保存\"\n        });\n      });\n    },\n\n    confirm() {\n      this.$confirm(\"请再次确定订单内容，该操作不可撤销\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        this.save();\n      }).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"已取消保存\"\n        });\n      });\n    },\n\n    save() {\n      let str = sessionStorage.getItem(\"user\");\n      this.form.userID = JSON.parse(str).id;\n      this.form.forcing = 0;\n\n      if (this.usingData.length === 0) {\n        this.$message({\n          type: \"error\",\n          message: \"订单不可为空\"\n        });\n        return;\n      }\n\n      request.post(\"/orders/save\", {\n        orders: this.form,\n        ordersContainer: this.usingData\n      }).then(res => {\n        if (res.code === 0) {\n          this.$message({\n            type: \"success\",\n            message: \"订单新增成功\"\n          });\n          this.usingData = [];\n          this.load();\n        } else {\n          this.$message({\n            type: \"error\",\n            message: res.msg\n          });\n        }\n      });\n    },\n\n    forceSave() {\n      let str = sessionStorage.getItem(\"user\");\n      this.form.userID = JSON.parse(str).id;\n      this.form.forcing = 1;\n\n      if (this.usingData.length === 0) {\n        this.$message({\n          type: \"error\",\n          message: \"订单不可为空\"\n        });\n        return;\n      }\n\n      request.post(\"/orders/save\", {\n        orders: this.form,\n        ordersContainer: this.usingData\n      }).then(res => {\n        if (res.code === 0) {\n          this.$message({\n            type: \"warning\",\n            message: \"订单已被强制下达\"\n          });\n          this.usingData = [];\n          this.load();\n        } else {\n          this.$message({\n            type: \"error\",\n            message: res.msg\n          });\n        }\n      });\n    },\n\n    load() {\n      request.get(\"/cuisine/view\", {\n        params: {\n          pageNum: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        this.tableData = res.data.records;\n        this.total = res.data.total;\n      });\n    },\n\n    handleAdd(row) {\n      //删除左侧\n      let index = this.tableData.indexOf(row);\n      if (index > -1) this.tableData.splice(index, 1); //添加amount属性\n\n      row.amount = 1; //初始化为1份\n      //id属性转移到cuisineID属性\n\n      row.cuisineID = row.id;\n      delete row.id;\n      this.usingData.push(row);\n    },\n\n    //Delete执行后原tableData会有冗余属性cuisineID,amount(delete太慢了尽量不用)\n    handleDelete(row) {\n      let index = this.usingData.indexOf(row);\n      if (index > -1) this.usingData.splice(index, 1); //id属性处理\n\n      row.id = row.cuisineID;\n      this.tableData.push(row);\n    },\n\n    handleCurrentChange(pageNum) {\n      //改变当前页码触发\n      this.currentPage = pageNum;\n      this.load();\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["request","name","data","form","tableData","usingData","currentPage","pageSize","total","search","options","value","label","created","load","methods","find","get","params","pageNum","then","res","records","forceConfirm","$confirm","confirmButtonText","cancelButtonText","type","forceSave","catch","$message","message","confirm","save","str","sessionStorage","getItem","userID","JSON","parse","id","forcing","length","post","orders","ordersContainer","code","msg","handleAdd","row","index","indexOf","splice","amount","cuisineID","push","handleDelete","handleCurrentChange"],"sourceRoot":"","sources":["C:\\Users\\laoshuaib\\Desktop\\restaurant\\src\\views\\orderMeal.vue"],"sourcesContent":["<template>\n  <!--    搜索头部区域-->\n  <div style=\"padding: 10px; height: 50px; line-height: 50px; margin-top: 20px\">\n    <el-row>\n      <el-col :span=\"10\">\n        <div style=\"display: flex\">\n          <el-input\n            v-model.trim=\"search\"\n            placeholder=\"请输入ID或菜品名\"\n            style=\"width: 45%\"\n            clearable\n          />\n          <el-button\n            type=\"primary\"\n            color=\"#fab6b6\"\n            style=\"margin-left: 10px\"\n            @click=\"find\"\n            >查询</el-button\n          >\n        </div>\n      </el-col>\n      <el-col :span=\"2\"><div /></el-col>\n      <el-col :span=\"12\">\n        <div style=\"display: flex\">\n          <el-input\n            v-model.trim=\"form.customer\"\n            placeholder=\"请输入顾客名\"\n            style=\"width: 45%\"\n            clearable\n          />\n          <el-select\n            v-model=\"form.type\"\n            placeholder=\"请选择订单类型\"\n            style=\"padding-left: 10px\"\n          >\n            <el-option\n              v-for=\"item in this.options\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            />\n          </el-select>\n          <el-button\n            type=\"primary\"\n            color=\"#fab6b6\"\n            style=\"margin-left: 10px\"\n            @click=\"confirm\"\n            >下单</el-button\n          >\n          <el-button\n            type=\"primary\"\n            color=\"#fab6b6\"\n            style=\"margin-left: 10px\"\n            @click=\"forceConfirm\"\n            >强制下单</el-button\n          >\n        </div>\n      </el-col>\n    </el-row>\n  </div>\n  <div style=\"padding: 10px\">\n    <el-row>\n      <el-col :span=\"10\">\n        <el-table\n          :data=\"tableData\"\n          height=\"530\"\n          :default-sort=\"{ prop: 'id', order: 'ascending' }\"\n        >\n          <el-table-column prop=\"id\" label=\"菜品ID\" width=\"120px\" sortable />\n          <el-table-column prop=\"name\" label=\"菜品名\" />\n          <el-table-column prop=\"price\" label=\"价格\" />\n          <el-table-column label=\"操作\" width=\"200px\" align=\"center\">\n            <template #default=\"scope\">\n              <el-button size=\"mini\" @click=\"handleAdd(scope.row)\"\n                >添加</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n        <div style=\"margin: 10px 0\">\n          <el-pagination\n            v-model:currentPage=\"currentPage\"\n            :page-sizes=\"[5, 10]\"\n            :page-size=\"pageSize\"\n            :total=\"total\"\n            layout=\"prev, pager, next\"\n            @current-change=\"handleCurrentChange\"\n          >\n          </el-pagination>\n        </div>\n      </el-col>\n      <el-col :span=\"2\"><div /></el-col>\n      <el-col :span=\"12\">\n        <el-table\n          :data=\"usingData\"\n          height=\"530\"\n          :default-sort=\"{ prop: 'id', order: 'ascending' }\"\n        >\n          <el-table-column\n            prop=\"cuisineID\"\n            label=\"菜品ID\"\n            width=\"120px\"\n            sortable\n          />\n          <el-table-column prop=\"name\" label=\"菜品名\" />\n          <el-table-column prop=\"price\" label=\"价格\" />\n          <el-table-column label=\"份数\" width=\"200px\" align=\"center\">\n            <template #default=\"scope\">\n              <el-input-number v-model=\"scope.row.amount\" :step=\"1\" />\n            </template>\n          </el-table-column>\n          <el-table-column label=\"操作\" width=\"100px\" align=\"center\">\n            <template #default=\"scope\">\n              <el-button size=\"mini\" @click=\"handleDelete(scope.row)\"\n                >删除</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport request from \"../../untils/request\";\n\nexport default {\n  name: \"orderMeal\",\n  data() {\n    return {\n      form: {},\n      tableData: [],\n      usingData: [],\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      search: \"\",\n      options: [\n        { value: 0, label: \"堂食\" },\n        { value: 1, label: \"外卖\" },\n      ],\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    find() {\n      request\n        .get(\"/cuisine/find\", {\n          params: {\n            pageNum: this.currentPage,\n            pageSize: this.pageSize,\n            search: this.search,\n          },\n        })\n        .then((res) => {\n          this.tableData = res.data.records;\n          this.total = res.data.total;\n        });\n    },\n    forceConfirm() {\n      this.$confirm(\"强制下单将忽略并不执行对于储量的影响,是否继续\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"error\",\n      })\n        .then(() => {\n          this.forceSave();\n        })\n        .catch(() => {\n          this.$message({\n            type: \"info\",\n            message: \"已取消保存\",\n          });\n        });\n    },\n    confirm() {\n      this.$confirm(\"请再次确定订单内容，该操作不可撤销\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(() => {\n          this.save();\n        })\n        .catch(() => {\n          this.$message({\n            type: \"info\",\n            message: \"已取消保存\",\n          });\n        });\n    },\n    save() {\n      let str = sessionStorage.getItem(\"user\");\n      this.form.userID = JSON.parse(str).id;\n      this.form.forcing = 0;\n      if (this.usingData.length === 0) {\n        this.$message({\n          type: \"error\",\n          message: \"订单不可为空\",\n        });\n        return;\n      }\n      request\n        .post(\"/orders/save\", {\n          orders: this.form,\n          ordersContainer: this.usingData,\n        })\n        .then((res) => {\n          if (res.code === 0) {\n            this.$message({\n              type: \"success\",\n              message: \"订单新增成功\",\n            });\n            this.usingData = [];\n            this.load();\n          } else {\n            this.$message({\n              type: \"error\",\n              message: res.msg,\n            });\n          }\n        });\n    },\n    forceSave() {\n      let str = sessionStorage.getItem(\"user\");\n      this.form.userID = JSON.parse(str).id;\n      this.form.forcing = 1;\n      if (this.usingData.length === 0) {\n        this.$message({\n          type: \"error\",\n          message: \"订单不可为空\",\n        });\n        return;\n      }\n      request\n        .post(\"/orders/save\", {\n          orders: this.form,\n          ordersContainer: this.usingData,\n        })\n        .then((res) => {\n          if (res.code === 0) {\n            this.$message({\n              type: \"warning\",\n              message: \"订单已被强制下达\",\n            });\n            this.usingData = [];\n            this.load();\n          } else {\n            this.$message({\n              type: \"error\",\n              message: res.msg,\n            });\n          }\n        });\n    },\n    load() {\n      request\n        .get(\"/cuisine/view\", {\n          params: {\n            pageNum: this.currentPage,\n            pageSize: this.pageSize,\n          },\n        })\n        .then((res) => {\n          this.tableData = res.data.records;\n          this.total = res.data.total;\n        });\n    },\n    handleAdd(row) {\n      //删除左侧\n      let index = this.tableData.indexOf(row);\n      if (index > -1) this.tableData.splice(index, 1);\n      //添加amount属性\n      row.amount = 1; //初始化为1份\n      //id属性转移到cuisineID属性\n      row.cuisineID = row.id;\n      delete row.id;\n      this.usingData.push(row);\n    },\n    //Delete执行后原tableData会有冗余属性cuisineID,amount(delete太慢了尽量不用)\n    handleDelete(row) {\n      let index = this.usingData.indexOf(row);\n      if (index > -1) this.usingData.splice(index, 1);\n      //id属性处理\n      row.id = row.cuisineID;\n      this.tableData.push(row);\n    },\n    handleCurrentChange(pageNum) {\n      //改变当前页码触发\n      this.currentPage = pageNum;\n      this.load();\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"less\">\n/deep/ .el-dialog {\n  background: #fcf9f4;\n}\n\n/deep/.el-form-item {\n  margin-bottom: 30px;\n}\n</style>\n<style lang=\"less\">\n.el-message-box {\n  background: #fcf9f4;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}