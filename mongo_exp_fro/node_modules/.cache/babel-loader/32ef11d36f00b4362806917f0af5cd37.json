{"ast":null,"code":"import request from \"../../untils/request\";\nexport default {\n  name: \"orderMeal\",\n\n  data() {\n    return {\n      form: {},\n      tableData: [],\n      usingData: [],\n      search: \"\"\n    };\n  },\n\n  created() {\n    this.load();\n  },\n\n  methods: {\n    find() {\n      request.get(\"/cuisine/findList\", {\n        params: {\n          search: this.search\n        }\n      }).then(res => {\n        this.tableData = res.data;\n      });\n    },\n\n    confirm() {\n      this.$confirm(\"请再次确定订单内容，该操作不可撤销\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        this.save();\n      }).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"已取消保存\"\n        });\n      });\n    },\n\n    save() {\n      if (this.usingData.length === 0) {\n        this.$message({\n          type: \"error\",\n          message: \"菜品配方不可为空\"\n        });\n        return;\n      }\n\n      request.post(\"/cuisine/save\", {\n        cuisine: this.form,\n        cuisineUsing: this.usingData\n      }).then(res => {\n        if (res.code === 0) {\n          this.$message({\n            type: \"success\",\n            message: \"菜品新增成功\"\n          });\n          this.usingData = [];\n          this.load();\n        } else {\n          this.$message({\n            type: \"error\",\n            message: res.msg\n          });\n        }\n      });\n    },\n\n    load() {\n      request.get(\"/cuisine/viewList\").then(res => {\n        this.tableData = res.data;\n      });\n    },\n\n    handleAdd(row) {\n      //删除左侧\n      let index = this.tableData.indexOf(row);\n      if (index > -1) this.tableData.splice(index, 1); //添加amount属性\n\n      row.amount = 1; //初始化为1份\n      //id属性转移到cuisineID属性\n\n      row.cuisineID = row.id;\n      delete row.id;\n      this.usingData.push(row);\n    },\n\n    //Delete执行后原tableData会有冗余属性ingredientID,dosage(delete太慢了尽量不用)\n    handleDelete(row) {\n      let index = this.usingData.indexOf(row);\n      if (index > -1) this.usingData.splice(index, 1); //id属性处理\n\n      row.id = row.ingredientID;\n      this.tableData.push(row);\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["request","name","data","form","tableData","usingData","search","created","load","methods","find","get","params","then","res","confirm","$confirm","confirmButtonText","cancelButtonText","type","save","catch","$message","message","length","post","cuisine","cuisineUsing","code","msg","handleAdd","row","index","indexOf","splice","amount","cuisineID","id","push","handleDelete","ingredientID"],"sourceRoot":"","sources":["C:\\Users\\laoshuaib\\Desktop\\restaurant\\src\\views\\orderMeal.vue"],"sourcesContent":["<template>\n  <!--    搜索头部区域-->\n  <div style=\"padding: 10px; height: 50px; line-height: 50px; margin-top: 20px\">\n    <el-row>\n      <el-col :span=\"10\">\n        <div style=\"display: flex\">\n          <el-input\n            v-model.trim=\"search\"\n            placeholder=\"请输入ID或菜品名\"\n            style=\"width: 45%\"\n            clearable\n          />\n          <el-button\n            type=\"primary\"\n            color=\"#fab6b6\"\n            style=\"margin-left: 10px\"\n            @click=\"find\"\n            >查询</el-button\n          >\n        </div>\n      </el-col>\n      <el-col :span=\"2\"><div /></el-col>\n      <el-col :span=\"10\">\n        <div style=\"display: flex\">\n          <el-button\n            type=\"primary\"\n            color=\"#fab6b6\"\n            style=\"margin-left: 10px\"\n            @click=\"confirm\"\n            >保存</el-button\n          >\n        </div>\n      </el-col>\n    </el-row>\n  </div>\n  <div style=\"padding: 10px\">\n    <el-row>\n      <el-col :span=\"10\">\n        <el-table\n          :data=\"tableData\"\n          height=\"530\"\n          :default-sort=\"{ prop: 'id', order: 'ascending' }\"\n        >\n          <el-table-column prop=\"id\" label=\"菜品ID\" width=\"120px\" sortable />\n          <el-table-column prop=\"name\" label=\"菜品名\" />\n          <el-table-column label=\"操作\" width=\"200px\" align=\"center\">\n            <template #default=\"scope\">\n              <el-button size=\"mini\" @click=\"handleAdd(scope.row)\"\n                >添加</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-col>\n      <el-col :span=\"2\"><div /></el-col>\n      <el-col :span=\"12\">\n        <el-table\n          :data=\"usingData\"\n          height=\"530\"\n          :default-sort=\"{ prop: 'id', order: 'ascending' }\"\n        >\n          <el-table-column\n            prop=\"ingredientID\"\n            label=\"食材ID\"\n            width=\"120px\"\n            sortable\n          />\n          <el-table-column prop=\"name\" label=\"食材名\" />\n          <el-table-column label=\"用量(g)\" width=\"200px\" align=\"center\">\n            <template #default=\"scope\">\n              <el-input-number\n                v-model=\"scope.row.dosage\"\n                :precision=\"1\"\n                :step=\"0.1\"\n              />\n            </template>\n          </el-table-column>\n          <el-table-column label=\"操作\" width=\"200px\" align=\"center\">\n            <template #default=\"scope\">\n              <el-button size=\"mini\" @click=\"handleDelete(scope.row)\"\n                >删除</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport request from \"../../untils/request\";\n\nexport default {\n  name: \"orderMeal\",\n  data() {\n    return {\n      form: {},\n      tableData: [],\n      usingData: [],\n      search: \"\",\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    find() {\n      request\n        .get(\"/cuisine/findList\", {\n          params: {\n            search: this.search,\n          },\n        })\n        .then((res) => {\n          this.tableData = res.data;\n        });\n    },\n    confirm() {\n      this.$confirm(\"请再次确定订单内容，该操作不可撤销\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(() => {\n          this.save();\n        })\n        .catch(() => {\n          this.$message({\n            type: \"info\",\n            message: \"已取消保存\",\n          });\n        });\n    },\n    save() {\n      if (this.usingData.length === 0) {\n        this.$message({\n          type: \"error\",\n          message: \"菜品配方不可为空\",\n        });\n        return;\n      }\n      request\n        .post(\"/cuisine/save\", {\n          cuisine: this.form,\n          cuisineUsing: this.usingData,\n        })\n        .then((res) => {\n          if (res.code === 0) {\n            this.$message({\n              type: \"success\",\n              message: \"菜品新增成功\",\n            });\n            this.usingData = [];\n            this.load();\n          } else {\n            this.$message({\n              type: \"error\",\n              message: res.msg,\n            });\n          }\n        });\n    },\n    load() {\n      request.get(\"/cuisine/viewList\").then((res) => {\n        this.tableData = res.data;\n      });\n    },\n    handleAdd(row) {\n      //删除左侧\n      let index = this.tableData.indexOf(row);\n      if (index > -1) this.tableData.splice(index, 1);\n      //添加amount属性\n      row.amount = 1; //初始化为1份\n      //id属性转移到cuisineID属性\n      row.cuisineID = row.id;\n      delete row.id;\n      this.usingData.push(row);\n    },\n    //Delete执行后原tableData会有冗余属性ingredientID,dosage(delete太慢了尽量不用)\n    handleDelete(row) {\n      let index = this.usingData.indexOf(row);\n      if (index > -1) this.usingData.splice(index, 1);\n      //id属性处理\n      row.id = row.ingredientID;\n      this.tableData.push(row);\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"less\">\n/deep/ .el-dialog {\n  background: #fcf9f4;\n}\n\n/deep/.el-form-item {\n  margin-bottom: 30px;\n}\n</style>\n<style lang=\"less\">\n.el-message-box {\n  background: #fcf9f4;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}