{"ast":null,"code":"import request from \"../../untils/request\";\nexport default {\n  name: \"addCuisine\",\n\n  data() {\n    return {\n      form: {},\n      tableData: [],\n      usingData: [],\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      search: \"\"\n    };\n  },\n\n  created() {\n    this.load();\n  },\n\n  methods: {\n    goBack() {\n      this.$router.push(\"/manager/cuisineManage\");\n    },\n\n    find() {\n      request.get(\"/ingredient/find\", {\n        params: {\n          pageNum: this.currentPage,\n          pageSize: this.pageSize,\n          search: this.search\n        }\n      }).then(res => {\n        this.tableData = res.data.records;\n        this.total = res.data.total;\n      });\n    },\n\n    goBackConfirm() {\n      this.$confirm(\"未保存数据将丢失\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        this.goBack();\n      });\n    },\n\n    confirm() {\n      this.$confirm(\"请确定菜品名字, 确定后不建议修改\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        this.save();\n      }).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"已取消保存\"\n        });\n      });\n    },\n\n    save() {\n      if (this.usingData.length === 0) {\n        this.$message({\n          type: \"error\",\n          message: \"菜品配方不可为空\"\n        });\n        return;\n      }\n\n      request.post(\"/cuisine/save\", {\n        cuisine: this.form,\n        cuisineUsing: this.usingData\n      }).then(res => {\n        if (res.code === 0) {\n          this.$message({\n            type: \"success\",\n            message: \"菜品新增成功\"\n          });\n          this.usingData = [];\n          this.load();\n        } else {\n          this.$message({\n            type: \"error\",\n            message: res.msg\n          });\n        }\n      });\n    },\n\n    load() {\n      request.get(\"/ingredient/view\", {\n        params: {\n          pageNum: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        this.tableData = res.data.records;\n        this.total = res.data.total;\n      });\n    },\n\n    handleAdd(row) {\n      //删除左侧\n      let index = this.tableData.indexOf(row);\n      if (index > -1) this.tableData.splice(index, 1); //添加dosage属性\n\n      row.dosage = 100; //初始化为100g\n      //id属性转移到ingredientID属性\n\n      row.ingredientID = row.id;\n      delete row.id;\n      this.usingData.push(row);\n    },\n\n    //Delete执行后原tableData会有冗余属性ingredientID,dosage(delete太慢了尽量不用)\n    handleDelete(row) {\n      let index = this.usingData.indexOf(row);\n      if (index > -1) this.usingData.splice(index, 1); //id属性处理\n\n      row.id = row.ingredientID;\n      this.tableData.push(row);\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["request","name","data","form","tableData","usingData","currentPage","pageSize","total","search","created","load","methods","goBack","$router","push","find","get","params","pageNum","then","res","records","goBackConfirm","$confirm","confirmButtonText","cancelButtonText","type","confirm","save","catch","$message","message","length","post","cuisine","cuisineUsing","code","msg","handleAdd","row","index","indexOf","splice","dosage","ingredientID","id","handleDelete"],"sourceRoot":"","sources":["C:\\Users\\laoshuaib\\Desktop\\mongo_exp_fro\\src\\views\\addCuisine.vue"],"sourcesContent":["<template>\n  <el-page-header content=\"新增菜品\" @back=\"goBackConfirm\" />\n  <!--    搜索头部区域-->\n  <div style=\"padding: 10px; height: 50px; line-height: 50px; margin-top: 20px\">\n    <el-row>\n      <el-col :span=\"10\">\n        <div style=\"display: flex\">\n          <el-input\n            v-model.trim=\"search\"\n            placeholder=\"请输入ID或食材名\"\n            style=\"width: 45%\"\n            clearable\n          />\n          <el-button\n            type=\"primary\"\n            color=\"#fab6b6\"\n            style=\"margin-left: 10px\"\n            @click=\"find\"\n            >查询</el-button\n          >\n        </div>\n      </el-col>\n      <el-col :span=\"2\"><div /></el-col>\n      <el-col :span=\"10\">\n        <div style=\"display: flex\">\n          <el-input\n            v-model.trim=\"form.name\"\n            placeholder=\"请输入菜品名\"\n            style=\"width: 45%\"\n            clearable\n          />\n          <el-input\n            v-model.trim=\"form.price\"\n            placeholder=\"请输入菜品价格\"\n            style=\"width: 45%; padding-left: 10px\"\n            clearable\n          />\n          <el-button\n            type=\"primary\"\n            color=\"#fab6b6\"\n            style=\"margin-left: 10px\"\n            @click=\"confirm\"\n            >保存</el-button\n          >\n        </div>\n      </el-col>\n    </el-row>\n  </div>\n  <div style=\"padding: 10px\">\n    <el-row>\n      <el-col :span=\"10\">\n        <el-table\n          :data=\"tableData\"\n          height=\"530\"\n          :default-sort=\"{ prop: 'id', order: 'ascending' }\"\n        >\n          <el-table-column prop=\"id\" label=\"食材ID\" width=\"120px\" sortable />\n          <el-table-column prop=\"name\" label=\"食材名\" />\n          <el-table-column label=\"操作\" width=\"200px\" align=\"center\">\n            <template #default=\"scope\">\n              <el-button size=\"mini\" @click=\"handleAdd(scope.row)\"\n                >添加</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n        <div style=\"margin: 10px 0\">\n          <el-pagination\n            v-model:currentPage=\"currentPage\"\n            :page-sizes=\"[5, 10]\"\n            :page-size=\"pageSize\"\n            :total=\"total\"\n            layout=\"prev, pager, next\"\n            @current-change=\"handleCurrentChange\"\n          >\n          </el-pagination>\n        </div>\n      </el-col>\n      <el-col :span=\"2\"><div /></el-col>\n      <el-col :span=\"12\">\n        <el-table\n          :data=\"usingData\"\n          height=\"530\"\n          :default-sort=\"{ prop: 'id', order: 'ascending' }\"\n        >\n          <el-table-column\n            prop=\"ingredientID\"\n            label=\"食材ID\"\n            width=\"120px\"\n            sortable\n          />\n          <el-table-column prop=\"name\" label=\"食材名\" />\n          <el-table-column label=\"用量(g)\" width=\"200px\" align=\"center\">\n            <template #default=\"scope\">\n              <el-input-number\n                v-model=\"scope.row.dosage\"\n                :precision=\"1\"\n                :step=\"0.1\"\n              />\n            </template>\n          </el-table-column>\n          <el-table-column label=\"操作\" width=\"200px\" align=\"center\">\n            <template #default=\"scope\">\n              <el-button size=\"mini\" @click=\"handleDelete(scope.row)\"\n                >删除</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport request from \"../../untils/request\";\n\nexport default {\n  name: \"addCuisine\",\n  data() {\n    return {\n      form: {},\n      tableData: [],\n      usingData: [],\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      search: \"\",\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    goBack() {\n      this.$router.push(\"/manager/cuisineManage\");\n    },\n    find() {\n      request\n        .get(\"/ingredient/find\", {\n          params: {\n            pageNum: this.currentPage,\n            pageSize: this.pageSize,\n            search: this.search,\n          },\n        })\n        .then((res) => {\n          this.tableData = res.data.records;\n          this.total = res.data.total;\n        });\n    },\n    goBackConfirm() {\n      this.$confirm(\"未保存数据将丢失\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      }).then(() => {\n        this.goBack();\n      });\n    },\n    confirm() {\n      this.$confirm(\"请确定菜品名字, 确定后不建议修改\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(() => {\n          this.save();\n        })\n        .catch(() => {\n          this.$message({\n            type: \"info\",\n            message: \"已取消保存\",\n          });\n        });\n    },\n    save() {\n      if (this.usingData.length === 0) {\n        this.$message({\n          type: \"error\",\n          message: \"菜品配方不可为空\",\n        });\n        return;\n      }\n      request\n        .post(\"/cuisine/save\", {\n          cuisine: this.form,\n          cuisineUsing: this.usingData,\n        })\n        .then((res) => {\n          if (res.code === 0) {\n            this.$message({\n              type: \"success\",\n              message: \"菜品新增成功\",\n            });\n            this.usingData = [];\n            this.load();\n          } else {\n            this.$message({\n              type: \"error\",\n              message: res.msg,\n            });\n          }\n        });\n    },\n    load() {\n      request\n        .get(\"/ingredient/view\", {\n          params: {\n            pageNum: this.currentPage,\n            pageSize: this.pageSize,\n          },\n        })\n        .then((res) => {\n          this.tableData = res.data.records;\n          this.total = res.data.total;\n        });\n    },\n    handleAdd(row) {\n      //删除左侧\n      let index = this.tableData.indexOf(row);\n      if (index > -1) this.tableData.splice(index, 1);\n      //添加dosage属性\n      row.dosage = 100; //初始化为100g\n      //id属性转移到ingredientID属性\n      row.ingredientID = row.id;\n      delete row.id;\n      this.usingData.push(row);\n    },\n    //Delete执行后原tableData会有冗余属性ingredientID,dosage(delete太慢了尽量不用)\n    handleDelete(row) {\n      let index = this.usingData.indexOf(row);\n      if (index > -1) this.usingData.splice(index, 1);\n      //id属性处理\n      row.id = row.ingredientID;\n      this.tableData.push(row);\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"less\">\n/deep/ .el-dialog {\n  background: #fcf9f4;\n}\n\n/deep/.el-form-item {\n  margin-bottom: 30px;\n}\n</style>\n<style lang=\"less\">\n.el-message-box {\n  background: #fcf9f4;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}